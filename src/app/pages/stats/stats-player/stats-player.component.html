<app-loading-spinner *ngIf="(!(playerOverviewData$ | async) || !(playerStatsData$ | async)) && !error"></app-loading-spinner>

<div class="wrapper" *ngIf="(playerOverviewData$ | async) as playerOverviewData">
  <div class="page" *ngIf="(playerStatsData$ | async) as playerStatsData">
    <div class="disclaimer">
      <fa-icon [icon]="faExclamationTriangle"></fa-icon> This page is still under construction and subject to change.
    </div>
    <div class="head" [style.backgroundImage]="'url(\'' + playerOverviewData.cover_image +'\')'">
      <div class="content">
        <img [src]="getProfilePicture(playerOverviewData)" class="avatar" alt="Avatar">
        <div class="country" *ngIf="playerOverviewData.country.toLowerCase() as country">
          <svg>
            <use [attr.xlink:href]="'assets/img/icons/flags/' + country + '.svg#flag-icons-' + country"></use>
          </svg>
        </div>
        <h1>{{ playerOverviewData.nickname }}</h1>
        <app-card>
          <div class="elo" *ngIf="playerOverviewData.games['csgo'].skill_level as level">
            <svg>
              <use [attr.xlink:href]="'assets/img/icons/levels/' + level + '.svg#level' + level"></use>
            </svg>
            <span class="ml-2">{{ playerOverviewData.games['csgo'].faceit_elo }}</span>
          </div>
        </app-card>
        <a class="faceit-btn" style="margin-left: auto" [href]="playerOverviewData.faceit_url.replace('{lang}', 'en')" target="_blank">
          View Profile on FACEIT
        </a>
      </div>
    </div>
    <app-elo-display class="w-full" [elo]="playerOverviewData.games['csgo'].faceit_elo"></app-elo-display>

    <div class="stats">
      <app-stat-display name="LEVEL"
        [value]="playerOverviewData.games['csgo'].skill_level + ' (' + playerOverviewData.games['csgo'].faceit_elo + ')'">
      </app-stat-display>
      <app-stat-display name="MATCHES" [value]="playerStatsData.lifetime.Matches"></app-stat-display>
      <app-stat-display name="WIN RATE" [value]="playerStatsData.lifetime['Win Rate %'] + '%'"></app-stat-display>
      <app-stat-display name="AVG. K/D" [value]="playerStatsData.lifetime['Average K/D Ratio']"></app-stat-display>
      <app-stat-display name="RECENT RESULTS" [value]="getRecentResults(playerStatsData)"></app-stat-display>
      <app-stat-display name="CURRENT WIN STREAK" [value]="playerStatsData.lifetime['Current Win Streak']">
      </app-stat-display>
      <app-stat-display name="LONGEST WIN STREAK" [value]="playerStatsData.lifetime['Longest Win Streak']">
      </app-stat-display>
      <app-stat-display name="AVG. HEADSHOT" [value]="playerStatsData.lifetime['Average Headshots %'] + '%'">
      </app-stat-display>
    </div>
  </div>
</div>
